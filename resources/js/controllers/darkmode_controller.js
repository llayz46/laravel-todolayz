import { Controller } from "@hotwired/stimulus"

// Connects to data-controller="darkmode"
export default class extends Controller {
    static targets = ['body', 'themeToggle']

    connect() {
        this.applyTheme();
        this.updateTheme();
    }

    toggleMode() {
        if (this.bodyTarget.classList.contains('dark')) {
            this.bodyTarget.classList.remove('dark')
            localStorage.setItem('theme', 'light')
        } else {
            this.bodyTarget.classList.add('dark')
            localStorage.setItem('theme', 'dark')
        }
        this.updateTheme();
    }

    applyTheme() {
        const theme = localStorage.getItem('theme');
        if (theme === 'dark') {
            this.bodyTarget.classList.add('dark');
        } else {
            this.bodyTarget.classList.remove('dark');
        }
    }

    updateTheme() {
        if (localStorage.getItem('theme') === 'dark') {
            this.themeToggleTarget.innerHTML =
                `
                <svg width="16" height="18" viewBox="0 0 23 25" fill="currentColor">
                    <path d="M12.6405 24.6512C10.0208 24.6512 7.44069 23.8177 5.33694 22.1903C2.5187 20.0468 0.811887 16.7919 0.61342 13.2195C0.375259 8.89295 2.67748 4.64575 6.40866 2.38323C8.55211 1.11304 10.894 0.517634 13.355 0.676408C13.871 0.716101 14.3077 1.03365 14.4664 1.50997C14.6252 1.98629 14.5458 2.50231 14.1886 2.85955C12.0848 4.9633 11.2116 7.98 11.8467 10.8776C12.7993 15.2042 16.848 18.1415 21.254 17.7049C21.77 17.6652 22.2463 17.9034 22.4845 18.34C22.7227 18.7766 22.7227 19.2926 22.4051 19.6896C20.6586 22.0712 18.1182 23.7383 15.2206 24.3734C14.3473 24.5719 13.4741 24.6512 12.6405 24.6512ZM12.1245 2.46261C10.4574 2.542 8.82996 3.01832 7.32161 3.93127C4.14614 5.83656 2.20116 9.44866 2.39962 13.1005C2.5584 16.1568 4.02706 18.9354 6.40866 20.7613C8.79027 22.5872 11.8864 23.262 14.8237 22.6269C16.9274 22.1903 18.793 21.0788 20.222 19.4911C15.3794 19.4514 11.1322 16.0378 10.0605 11.2349C9.38567 8.13877 10.1398 4.92361 12.1245 2.46261Z"/>
                </svg> Dark
                `;
        } else {
            this.themeToggleTarget.innerHTML =
                `
                 <svg width="20" height="20" viewBox="0 0 25 25" fill="currentColor">
                    <path d="M12.6374 7.25134C9.66707 7.25134 7.25122 9.66719 7.25122 12.6375C7.25122 15.6078 9.66707 18.0236 12.6374 18.0236C15.6077 18.0236 18.0235 15.6078 18.0235 12.6375C18.0235 9.66719 15.6077 7.25134 12.6374 7.25134ZM12.6374 16.2415C10.6572 16.2415 9.0334 14.6177 9.0334 12.6375C9.0334 10.6573 10.6572 9.03352 12.6374 9.03352C14.6176 9.03352 16.2413 10.6573 16.2413 12.6375C16.2413 14.6177 14.6176 16.2415 12.6374 16.2415Z"/>
                    <path d="M12.6375 4.4395C13.1127 4.4395 13.5483 4.04346 13.5483 3.5286V1.5484C13.5483 1.07316 13.1523 0.637512 12.6375 0.637512C12.1622 0.637512 11.7266 1.03355 11.7266 1.5484V3.56821C11.7662 4.04346 12.1622 4.4395 12.6375 4.4395Z"/>
                    <path d="M12.6375 20.8355C12.1622 20.8355 11.7266 21.2316 11.7266 21.7464V23.7266C11.7266 24.2019 12.1226 24.6375 12.6375 24.6375C13.1127 24.6375 13.5483 24.2415 13.5483 23.7266V21.7068C13.5483 21.2316 13.1127 20.8355 12.6375 20.8355Z"/>
                    <path d="M19.0929 7.09294C19.3305 7.09294 19.5681 7.01374 19.7266 6.81572L20.9939 5.54839C21.3503 5.19195 21.3503 4.6375 20.9939 4.28106C20.6374 3.92462 20.083 3.92462 19.7266 4.28106L18.4592 5.54839C18.1028 5.90482 18.1028 6.45928 18.4592 6.81572C18.6176 7.01374 18.8553 7.09294 19.0929 7.09294Z"/>
                    <path d="M5.58788 18.4593L4.32055 19.687C3.96411 20.0434 3.96411 20.5979 4.32055 20.9543C4.47897 21.1127 4.71659 21.2315 4.95421 21.2315C5.19184 21.2315 5.42946 21.1523 5.58788 20.9543L6.85521 19.687C7.21164 19.3306 7.21164 18.7761 6.85521 18.4197C6.49877 18.1028 5.90471 18.1028 5.58788 18.4593Z"/>
                    <path d="M23.7265 11.7662H21.7067C21.2314 11.7662 20.7958 12.1622 20.7958 12.6771C20.7958 13.1523 21.1918 13.588 21.7067 13.588H23.7265C24.2017 13.588 24.6374 13.1919 24.6374 12.6771C24.6374 12.1622 24.2017 11.7662 23.7265 11.7662Z"/>
                    <path d="M4.43944 12.6375C4.43944 12.1623 4.0434 11.7266 3.52854 11.7266H1.54834C1.0731 11.7266 0.637451 12.1227 0.637451 12.6375C0.637451 13.1128 1.03349 13.5484 1.54834 13.5484H3.56815C4.0434 13.5484 4.43944 13.1128 4.43944 12.6375Z"/>
                    <path d="M19.6869 18.4593C19.3304 18.1028 18.776 18.1028 18.4195 18.4593C18.0631 18.8157 18.0631 19.3702 18.4195 19.7266L19.6869 20.9939C19.8453 21.1524 20.0829 21.2712 20.3205 21.2712C20.5582 21.2712 20.7958 21.192 20.9542 20.9939C21.3106 20.6375 21.3106 20.083 20.9542 19.7266L19.6869 18.4593Z"/>
                    <path d="M5.58788 4.32073C5.23144 3.9643 4.67699 3.9643 4.32055 4.32073C3.96411 4.67717 3.96411 5.23162 4.32055 5.58806L5.58788 6.85539C5.74629 7.0138 5.98392 7.13262 6.22154 7.13262C6.45917 7.13262 6.69679 7.05341 6.85521 6.85539C7.21164 6.49895 7.21164 5.9445 6.85521 5.58806L5.58788 4.32073Z"/>
                </svg>Light
                `;
        }
    }
}
